
# spcmake_byFF6 HexMMLコマンド一覧

## コメントアウト

// 以降改行までコメントアウト

    C4 60 // 音量

/\* から \*/ まで複数行コメントアウト

    /*
    B6 C6
    B8
    */
    BA


## 以下トラック記述前に定義するもの

## #songname "_kyokumei_"

曲名を設定します。

## #gametitle "_ge-mumei_"

ゲーム曲であれば設定します。

## #artist "_Yamada Taro_"

作曲者を設定します。

## #dumper "_pgate1_"

HexMMLの作成者を設定します。つまりあなたの名前。

## #comment "_nanikakaku_"

SPCプレイヤで表示されるコメントを設定します。

## #length _play_time fade_out_time_

曲の再生時間とフェードアウト時間(ms)を設定します。
デフォルトでは再生時間( _play_time_ )300秒、フェードアウト時間( _fade_out_time_ )10000msとなっています。
SPCプレイヤによって対応していたり対応していなかったり。

    #length 2:30 4000 // 再生時間2分30秒、フェードアウト時間4秒
    #length 150 10000 // 再生時間150秒、フェードアウト時間10秒

## #brr_offset _offset_

BRRデータのAPUメモリ内配置位置を指定するオプションです。
デフォルトは _offset_ = 0x4800です。

    #brr_offset 0x3000 // BRRデータを0x3000から配置します
    #brr_offset auto // BRRデータをシーケンスデータの直後に配置します

## #brr_echo_overcheck

このオプション設定を記述すると、BRRデータ領域がエコーバッファ領域と重なっていないかチェックし、重なっている場合はエラーとします。  
エコーバッファ領域はデフォルトで0xCD00～0xF4FFとなっています。

## #echo_depth _depth_

エコーのかかり具合を指定します。  
_depth_ はエコーの深さです。1(浅い)～15(深い)の間で指定してください。デフォルトは5です。

## #surround

逆位相サラウンドを有効にするオプション設定です。  
MVOL_Rに0x3Fの代わりに0xC1を設定します。

## #swap<> #swap><

オクターブ変更コマンド < \> の機能を入れ替えます。

## #auto_assign_toneid

これを宣言すると、tone宣言で _tone_id_ を省略できます。
省略された _tone_id_ には32から順に内部idが割り当てられます。

## #tone (音色定義)

音色を設定します。
基本的に音色を使用するトラック宣言の前に定義します。

#tone _tone_id "brr_file_name" octave transpose detune attack_rate decay_rate sustain_level sustain_rate_

    #tone 1 "brr/harp.brr" 05 02 00 0F 07 07 0B // 自分で用意したBRRファイルを使用する場合
    #tone 2 "FF6inst:01" 05 00 00 // FF6内蔵波形を使用（オクターブ等指定あり）
    #tone 3 "FF6inst:05" // FF6内蔵音源を使用（オクターブ等はFF6基準を使用）
    #tone 4 "FF6inst:s0" 5 0 0 // FF6常駐音源を使用（オクターブ等指定あり）
    #tone 5 "FF6inst:s3" // FF6常駐音源を使用（オクターブ等はFF6基準を使用）

_tone_id_ 数字（例：1, 3, 0A, 1C）や、文字列（例：base, TAM）を宣言します。
  
FF6内蔵波形はFF6inst:00～3E(16進数)を指定できます。  
FF6常駐波形はFF6inst:s0～s7を指定できます。  
FF6instを指定する場合はオクターブ・トランスポーズ・ディチューン設定を省略することができます。
この場合、生成されるSPCにはそれぞれのコマンドは埋め込まれません。
  
_octave_ （オクターブ）は0以上の値を設定できます。  
_transpose_ （トランスポーズ）は80～7F(-128～127)の値を設定できます。  
_detune_ （ディチューン）は80～7F(-128～127)の値を設定できます。
  
自前の.brrを使用する場合はADSRパラメータも指定してください。  
_attack_rate_ 0～F 大きいほど立ち上がりが早いです。  
_decay_rate_ 0～7 大きいほどSustainLevelになる速度が速いです。  
_sustain_level_ 0～7 大きいほど減衰が少ないです。  
_sustain_rate_ 00～1F 大きいほど減衰が速いです。  

今のところtone宣言は32個までとさせてください。

## #track _track_num_

トラックを設定します。
スーファミ音源は8チャンネルなので、 _track_num_ は1～8で設定できます。
これ以降、次の#trackまでがそのトラックのシーケンスとなります。

## #macro _macro_key_ "_macro_value_"

マクロを定義します。  
これ以降の記述において、 _macro_key_ が _macro_value_ に置き換えられます。

    #macro baseA "1C < 8C > 00 1C"
    ...
    [ baseA ]4 // baseA が 1C < 8C > 00 1C に置き換えられる

## L

トラックループです。
これ以降のシーケンスがトラック終了からループします。  
シーケンスでは最後に制御コマンドF6が追加されます。

## @_n_

#toneで定義した音色を選択します。

    @1 @3 @0A @1C @base @TAM

## [...]_n_

ループです。[ ] 内を _n_ 回繰り返します。多重ループも可能です。  
シーケンスでは [ が E2 に、] が E3 に置き換えられます。

    [ 23 85 ]2 // 23 85 23 85

    [ [ 23 85 ]2 3F 07 ]2 // 23 85 23 85 3F 07 23 85 23 85 3F 07 

## | (パイプ)

ループブレイクポイントで、ループの最後にループを抜けます。  
シーケンスでは|がF5に置き換えられます。  
多重ループの中でも使用できます。

    [ 23 | 85 ]3 07 // 23 85 23 85 23 07

## > <

オクターブ操作です。\>で+1オクターブ、<で-1オクターブします。  
シーケンスでは>はD7に、<はD8に置き換えられます。

## J _label_

トラック内任意場所へのジャンプで、順方向ジャンプ、逆方向ジャンプが可能です。  
異なるトラックであれば同じラベル名を使用できます。  
注意、本コマンドの使用によりticks計算が正確でなくなる可能性があります。

_label_ 任意文字列可。

    82 84
    J lp // ラベルlpへジャンプ
    66 66 66
    lp:  // ジャンプ先ラベル
    4A 4C
    J lp // ラベルlpへジャンプ
    20

    結果：82 84 4A 4C 4A 4C ...

## d

10進数を記述します。使用できるのはトラック内のみです。

    d93 // 5Dに変換される
    d-15 // F1に変換される

## @@_n_

効果音をシーケンスに埋め込みます。  
_n_ は効果音番号で 0～505 までです。

## !

この記号以降のコンパイルをストップします。

以上。
